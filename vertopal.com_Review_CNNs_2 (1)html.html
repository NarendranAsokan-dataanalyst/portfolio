<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>df0a5127790e45cb8dd5e79c0338be61</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="7a54ccbe" class="cell markdown" id="7a54ccbe">
<h2 id="convolutions">Convolutions</h2>
</div>
<div id="63d8b9e7" class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="63d8b9e7" data-outputId="a3009eb4-0f9d-4187-f857-f4bc5d4f2f0d">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(<span class="dv">123</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.integers(<span class="dv">0</span>, <span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>x<span class="op">=</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>f3 <span class="op">=</span> rng.integers(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, size<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>f3<span class="op">=</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>f5 <span class="op">=</span> rng.integers(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, size<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>f5<span class="op">=</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>x=array([[0, 6, 5, 0, 9, 2],
       [2, 1, 3, 1, 3, 8],
       [4, 9, 4, 2, 7, 8],
       [8, 8, 0, 5, 2, 2],
       [2, 8, 7, 2, 4, 7],
       [1, 6, 4, 9, 7, 2]])

f3=array([[ 2,  1, -2],
       [ 0,  1, -2],
       [-2, -3, -3]])

f5=array([[-1, -3,  0, -1, -2],
       [-1, -3, -3, -1, -3],
       [ 1, -2,  2, -2,  0],
       [ 0,  2,  0,  2, -1],
       [-2, -2,  2, -2,  1]])

</code></pre>
</div>
</div>
<div id="81894435" class="cell markdown" id="&quot;81894435&quot;">
<p>Calculate via code the convolutional output of the above array and
the filters <code>f3</code> and <code>f5</code> assuming:</p>
<ul>
<li><code>padding="valid"</code></li>
<li><code>padding="same"</code> (see if <code>np.pad()</code>
helps)</li>
</ul>
<p>Verify a few calculations by hand.</p>
</div>
<div id="6Bzl62a5SbgA" class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="6Bzl62a5SbgA" data-outputId="5f1d9854-5c5e-4a10-99d9-35f9b489591d">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>f3.shape[<span class="dv">0</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">
<pre><code>3</code></pre>
</div>
</div>
<div id="hnFi90t2lZL2" class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="hnFi90t2lZL2" data-outputId="7ed41e4f-7142-4a88-ea1a-52c88aa88a59">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="op">=</span> np.zeros((x.shape[<span class="dv">0</span>] <span class="op">-</span> f3.shape[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, x.shape[<span class="dv">1</span>] <span class="op">-</span> f3.shape[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(v1)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[[0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]
</code></pre>
</div>
</div>
<div id="bbae32b7" class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="bbae32b7" data-outputId="5f3dfc62-ddd8-4da0-d1b5-c7096d4f17e6">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convolution with padding=&quot;valid&quot;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(v1.shape[<span class="dv">0</span>]):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(v1.shape[<span class="dv">1</span>]):</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        v1[i, j] <span class="op">=</span> np.<span class="bu">sum</span>(x[i:i<span class="op">+</span>f3.shape[<span class="dv">0</span>], j:j<span class="op">+</span>f3.shape[<span class="dv">1</span>]] <span class="op">*</span> f3)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Convolution with f3 and padding=&quot;valid&quot;:</span><span class="ch">\n</span><span class="sc">{</span>v1<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>v2 <span class="op">=</span> np.zeros((x.shape[<span class="dv">0</span>] <span class="op">-</span> f5.shape[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, x.shape[<span class="dv">1</span>] <span class="op">-</span> f5.shape[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(v2.shape[<span class="dv">0</span>]):</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(v2.shape[<span class="dv">1</span>]):</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        v2[i, j] <span class="op">=</span> np.<span class="bu">sum</span>(x[i:i<span class="op">+</span>f5.shape[<span class="dv">0</span>], j:j<span class="op">+</span>f5.shape[<span class="dv">1</span>]] <span class="op">*</span> f5)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Convolution with f5 and padding=&quot;valid&quot;:</span><span class="ch">\n</span><span class="sc">{</span>v2<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Convolution with f3 and padding=&quot;valid&quot;:
[[-56. -18. -48. -57.]
 [-40. -28. -32. -42.]
 [-32. -35. -35. -44.]
 [-14. -42. -61. -47.]]

Convolution with f5 and padding=&quot;valid&quot;:
[[ -52. -108.]
 [ -97.  -72.]]

</code></pre>
</div>
</div>
<div id="f8b33754" class="cell code" id="f8b33754"
data-outputId="79ce6105-c128-4701-9268-d28cc8d3259a">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Padding for same convolution</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pad_width_f3 <span class="op">=</span> ((f3.shape[<span class="dv">0</span>] <span class="op">//</span> <span class="dv">2</span>, f3.shape[<span class="dv">0</span>] <span class="op">//</span> <span class="dv">2</span>), (f3.shape[<span class="dv">1</span>] <span class="op">//</span> <span class="dv">2</span>, f3.shape[<span class="dv">1</span>] <span class="op">//</span> <span class="dv">2</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>x_padded_f3 <span class="op">=</span> np.pad(x, pad_width<span class="op">=</span>pad_width_f3, mode<span class="op">=</span><span class="st">&#39;constant&#39;</span>, constant_values<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>v3 <span class="op">=</span> np.zeros(x.shape)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(v3.shape[<span class="dv">0</span>]):</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(v3.shape[<span class="dv">1</span>]):</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        v3[i, j] <span class="op">=</span> np.<span class="bu">sum</span>(x_padded_f3[i:i<span class="op">+</span>f3.shape[<span class="dv">0</span>], j:j<span class="op">+</span>f3.shape[<span class="dv">1</span>]] <span class="op">*</span> f3)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Convolution with f3 and padding=&quot;same&quot;:</span><span class="ch">\n</span><span class="sc">{</span>v3<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>pad_width_f5 <span class="op">=</span> ((f5.shape[<span class="dv">0</span>] <span class="op">//</span> <span class="dv">2</span>, f5.shape[<span class="dv">0</span>] <span class="op">//</span> <span class="dv">2</span>), (f5.shape[<span class="dv">1</span>] <span class="op">//</span> <span class="dv">2</span>, f5.shape[<span class="dv">1</span>] <span class="op">//</span> <span class="dv">2</span>))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>x_padded_f5 <span class="op">=</span> np.pad(x, pad_width<span class="op">=</span>pad_width_f5, mode<span class="op">=</span><span class="st">&#39;constant&#39;</span>, constant_values<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>v4 <span class="op">=</span> np.zeros(x.shape)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(v4.shape[<span class="dv">0</span>]):</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(v4.shape[<span class="dv">1</span>]):</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        v4[i, j] <span class="op">=</span> np.<span class="bu">sum</span>(x_padded_f5[i:i<span class="op">+</span>f5.shape[<span class="dv">0</span>], j:j<span class="op">+</span>f5.shape[<span class="dv">1</span>]] <span class="op">*</span> f5)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Convolution with f5 and padding=&quot;same&quot;:</span><span class="ch">\n</span><span class="sc">{</span>v4<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Convolution with f3 and padding=&quot;same&quot;:
[[-21. -20.  -9. -36. -30. -28.]
 [-51. -56. -18. -48. -57. -10.]
 [-62. -40. -28. -32. -42.  12.]
 [-52. -32. -35. -35. -44.  -5.]
 [-43. -14. -42. -61. -47.  -7.]
 [-25.  -4.   5.   3.  -3.  17.]]

Convolution with f5 and padding=&quot;same&quot;:
[[ -19.   15.  -16.  -46.   23.  -10.]
 [  -5.  -12.  -81.  -39.  -33.  -18.]
 [ -31.   -7.  -52. -108.  -42.  -51.]
 [ -37.  -33.  -97.  -72.  -61.  -72.]
 [ -53.  -84.  -71.  -65.  -22.  -18.]
 [ -53.  -75. -123.  -72.  -53.  -47.]]

</code></pre>
</div>
</div>
<div id="df9ad269" class="cell markdown" id="df9ad269">
<h2 id="pooling">Pooling</h2>
</div>
<div id="de0f44b1" class="cell code" id="de0f44b1"
data-outputId="13662802-4773-490b-fd9c-4933f6fe89bc">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(<span class="dv">234</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.integers(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<pre><code>array([[ -1,   6,  -4,  -1,  -9,  -5],
       [  9,  -5,   7,   0,  -6,   5],
       [  2,   7,  -5,  -7,   8,  -1],
       [-10,   3,   8,   9,   2,   7],
       [  5,  -7,   5,   2,   0,   7],
       [-10,   0,  -5, -10,  -7,   8]], dtype=int64)</code></pre>
</div>
</div>
<div id="6ce0ba59" class="cell markdown" id="6ce0ba59">
<p>Calculate the output of a pooling operation assuming no padding and
using a pooling layer:</p>
<ul>
<li><code>pool_size = (2, 2)</code> and <code>strides=2</code> and
<em>Max Pooling</em> is used</li>
<li><code>pool_size = (3, 3)</code> and <code>strides=2</code> and
<em>Max Pooling</em> is used</li>
<li><code>pool_size = (2, 2)</code> and <code>strides=1</code> and
<em>Max Pooling</em> is used</li>
<li><code>pool_size = (3, 3)</code> and <code>strides=1</code> and
<em>Max Pooling</em> is used</li>
<li><code>pool_size = (2, 2)</code> and <code>strides=2</code> and
<em>Average Pooling</em> is used</li>
<li><code>pool_size = (3, 3)</code> and <code>strides=2</code> and
<em>Average Pooling</em> is used</li>
<li><code>pool_size = (2, 2)</code> and <code>strides=1</code> and
<em>Average Pooling</em> is used</li>
<li><code>pool_size = (3, 3)</code> and <code>strides=1</code> and
<em>Average Pooling</em> is used</li>
</ul>
</div>
<div id="70faa5ad" class="cell code" id="70faa5ad">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> MaxPooling2D</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code></pre></div>
</div>
<div id="a433724e" class="cell code" id="a433724e"
data-outputId="3eaf5941-2843-447e-de7c-66d7792807a3">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x.reshape([<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">1</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>max_pool_2d1 <span class="op">=</span> MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">3</span>),  <span class="co"># define the max pooling layer</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                           strides<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>max_pool_2d1(x).numpy()</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">
<pre><code>array([[[[9],
         [8]],

        [[8],
         [9]]]], dtype=int64)</code></pre>
</div>
</div>
<div id="23e7b91b" class="cell markdown" id="23e7b91b">
<h2 id="parameter-calculation">Parameter calculation</h2>
</div>
<div id="436800ba" class="cell markdown" id="436800ba">
<p>How many trainable parameters does the following model have:</p>
<ul>
<li>input data has dimensions (180, 180, 3)</li>
<li>Conv2D(32, kernel_size=(5, 5), activation="relu")</li>
<li>AveragePooling(pool_size=(2, 2), strides=2)</li>
<li>Conv2D(32, kernel_size=(5, 5), activation="relu")</li>
<li>AveragePooling(pool_size=(2, 2), strides=2)</li>
<li>Flatten()</li>
<li>Dense(128, activation="relu")</li>
<li>Dense(3, activation="softmax")</li>
</ul>
</div>
<div id="cd621d3e" class="cell code" id="cd621d3e">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#5*5*3*32+32 - con-1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#5*5*32*32+32 - ccon-2</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#45*45*32*128 +128 - dense-128( 45 is because 180/2-avpooling 2x2 stide2 -90 then again avpooling 2x2 stide2 will give to 45 )</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#128*3 +3 - dense-3</span></span></code></pre></div>
</div>
<div id="9e48097f" class="cell markdown" id="9e48097f">
<p>To calculate the output dimensions after applying a 7x7 average
pooling to a 180x180 input, we need to consider the stride.</p>
<p>Let's assume a stride of 7:</p>
<p>Height: (180 - 7) / 7 + 1 = 25 Width: (180 - 7) / 7 + 1 = 25
Therefore, the output dimensions would be 25x25.</p>
<p>Note: The stride value significantly impacts the output size. If you
choose a different stride, the output dimensions will change
accordingly.</p>
<p>For example, with a stride of 1:</p>
<p>Height: (180 - 7) / 1 + 1 = 174 Width: (180 - 7) / 1 + 1 = 174 In
this case, the output dimensions would be 174x174.</p>
<p>Remember that the depth (number of channels) remains unchanged after
the pooling operation. So, if the input has 32 channels, the output will
also have 32 channels.</p>
</div>
<div id="3e206130" class="cell markdown" id="3e206130">
<p>Create fully-connected and convolutional neural networks using both
the <strong>sequential</strong> and the <strong>functional</strong>
API's in Keras.</p>
</div>
<div id="6763634c" class="cell code" id="6763634c">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="20b1d80f" class="cell markdown" id="20b1d80f">
<p>What do we mean by the <strong>receptive field</strong> of a filter
in a convolutional neural network?</p>
</div>
<div id="7ae73770" class="cell markdown" id="7ae73770">
<p>What 2 properties do convolutional neural networks have that make
them much more useful for images than fully-connected networks?</p>
</div>
<div id="62b5f91a" class="cell markdown" id="62b5f91a">
<p>Explain/use <strong>padding</strong>.</p>
</div>
<div id="90965027" class="cell markdown" id="&quot;90965027&quot;">
<p>Explain/use <strong>strides</strong>.</p>
</div>
<div id="0ad04580" class="cell markdown" id="0ad04580">
<p>What is the purpose of a <strong>pooling</strong> layer?</p>
</div>
<div id="9303fcfe" class="cell markdown" id="9303fcfe">
<p>What is the difference between a <strong>parameter</strong> and a
<strong>hyperparameter</strong>?</p>
</div>
<div id="654ce927" class="cell markdown" id="654ce927">
<p>What are training, validation, and test datasets used for?</p>
</div>
<div id="105ed313" class="cell markdown" id="105ed313">
<p>What is a baseline and how is it used?</p>
</div>
<div id="f4aaf6fc" class="cell markdown" id="f4aaf6fc">
<p>What are the first 2 goals we should have when creating a deep
learning model?</p>
</div>
<div id="7a816111" class="cell markdown" id="7a816111">
<p>What are some ways to deal with overfitting?</p>
</div>
<div id="c849553c" class="cell markdown" id="c849553c">
<p>What are some common problems when training a model and how can they
be overcome?</p>
</div>
<div id="f691c135-4a76-4a88-b61a-908bf35a84af" class="cell markdown"
id="f691c135-4a76-4a88-b61a-908bf35a84af">
<p>Transfer learning/Fine-tuning</p>
<ul>
<li>what is it? why do we do it?</li>
<li>import pre-trained model</li>
<li>build a new model using all or part of pre-trained model</li>
<li>freeze parameters</li>
</ul>
</div>
<div id="01bd846f-1b16-4dd5-bc90-69138b4b2998" class="cell markdown"
id="01bd846f-1b16-4dd5-bc90-69138b4b2998">
<p>Data augmentation</p>
<ul>
<li>what is it? why do we do it?</li>
<li>how to create a data augmentation layer</li>
</ul>
</div>
<div id="00460c19-c760-45e1-bb80-15116bc6ce57" class="cell code"
id="00460c19-c760-45e1-bb80-15116bc6ce57">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
